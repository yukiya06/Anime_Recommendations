# 애니메이션 추천 시스템 개발
## 랜덤포레스트 모델을 통한 추천여부(분류) 예측

* 데이터 분석 및 발표 : 안나 (Email: naan74532@gmail.com)
* 전체 발표자료 [PDF](https://github.com/yukiya06/Anime_Recommendations/blob/main/DA_%EC%95%88%EB%82%98_%EC%95%A0%EB%8B%88%EB%A9%94%EC%9D%B4%EC%85%98_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C.pdf)

---
## 프로젝트 전체 목차
#### 1. 서론
  * 주제 선정 이유 및 데이터 구성
  * 문제 정의 및 가설 설정

#### 2.  탐색적 자료 분석 및 시각화 
  * 데이터 전처리
  * 탐색적 자료 분석 (EDA)

#### 3. 머신러닝(ML)을 통한 추천 예측
  * 기준 모델
  * 모델간 성능 비교
  * 최종 모델(랜덤포레스트) 평가지표 해석

#### 4. 애니메이션 추천 시스템

#### 5. 한계점 및 추후 발전방향

---
## 프로젝트 요약
### 1. 주제 선정 이유
* 최근 콘텐츠 산업에서 작품 퀄리티 만큼 중요한 것이 '추천 서비스'입니다. 사용자들의 영상 댓글에서 손쉽게 ‘알 수 없는 알고리즘이 나를 이 영상으로 이끌었다.’, ‘나는 이 영상을 검색해서 본 것이 아니다.' 라는 내용을 만날 수 있습니다.
* 콘텐츠 산업 뿐만아니라 모든 커머셜 사이트에서도 고객 정보를 활용한 맞춤형 추천 서비스는 매출에 직결되는 만큼 중요합니다. 이러한 트렌드에 발맞춰 애니메이션 소셜 사이트의 자료를 기반으로 머신러닝을 활용하여 **유저의 추천여부를 예측**하고, 간단한 **애니메이션 추천 시스템**을 만들어 보고자 합니다.

### 2. 문제 정의 및 가설 설정
* 추천에 관한 검증은 기준이 매우 다양하고 복잡하므로 **'추천 한다, 하지 않는다' 이진분류 문제**로 단순화 합니다.
* 유저가 남긴 애니메이션 평점이, 기존의 유저가 남겼던 평점들의 평균보다 높을 때 추천한다고 가정합니다.

<img width="800" alt="문제정의" src="https://user-images.githubusercontent.com/91524805/167522494-208ffdc4-e2d4-4089-b8bf-aef1689251bd.png">

### 3. 데이터 구성 및 전처리
* 선정데이터: 캐글 [Anime Recommendations Database](https://www.kaggle.com/CooperUnion/anime-recommendations-database)
* '애니메이션'과 '평가' 데이터셋으로 나뉩니다.  
  1) 애니메이션: 애니메이션에 대한 설명 및 사용고객의 추천 청보로 평가를 가지고 있습니다.
  2) 평가: 각 고객은 자신의 리스트에 평가를 할 수 있고, 그것이 애니메이션 점수로 표시됩니다.  
* 기타 상세 내용: myanimelist.net API에서 참고

<img width="800" alt="데이터 전처리" src="https://user-images.githubusercontent.com/91524805/167523219-bd7ff942-78a0-4b0c-bce9-df2c13fa5c13.png">

* 데이터셋 합친후 타겟값의 불균형이 심하지 않으므로 보정없이 그대로 사용 합니다.
* 머신러닝 학습시 데이터 유출가능성을 감안하여 변형된 항목을 일부 추가합니다.  

### 4. 탐색적 자료 분석 (EDA)
<img width="800" alt="탐색적 데이터분석" src="https://user-images.githubusercontent.com/91524805/167523940-01a4ce73-065f-4e84-8698-cc81f8a669ca.png">

### 5. 머신러닝(ML)을 통한 추천 예측

* 머신러닝은 컴퓨터가 데이터를 통해 학습하고 패턴을 감지하여 결과를 도출해 냅니다. 따라서 학습을 위한 데이터와 이를 통해 만든 모델이 잘 작동하는지 검증할 데이터를 나누는 과정이 필요합니다. 
* 전체적인 **분석 과정**과 **성능 비교 결과**는 다음과 같습니다.

<img width="800" alt="머신러닝_01" src="https://user-images.githubusercontent.com/91524805/167524475-bf23d50f-38a3-43dc-8a1b-528be890cd4a.png">

<img width="820" alt="머신러닝_02" src="https://user-images.githubusercontent.com/91524805/167524582-2b38948b-0d60-43d5-9a79-1b11a8c53366.png">

* 훈련 정확도 '1'은 **데이터 누수**로 판단됩니다. 
   * 데이터 누수: 훈련용 데이터에 타겟 값이 누수되어 학습에 사용되면, 훈련정확도가 지나치게 높아집니다.  
   * 사용하지 말아야 할 정보가 포함된 것으로 사용 특성을 조정합니다. 
* **결정트리 모델**은 데이터를 분할해 나가면서 규칙, 패턴을 찾아 예측 하는 모델입니다.
* **앙상블 모델**은 트리를 여러 개 사용하여 예측결과를 종합합니다. 모델의 성능이 향상되지만 복잡도가 높아집니다.
* 분류 평가지표  
  * **정확도**는 예상이 맞았던 부분만 수치화 하여 검증한 것이고, 모델을 평가하는 지표는 목적에 따라 여러가지가 있습니다.
  * 보다 균형적인 검증을 위해 **F1_score**라는 수치를 함께 살펴보며, 간단하게는 수치가 높으면 모델 성능이 더 높다고 판단할 수 있습니다.
  * 모델의 성능을 조절하는 하이퍼파라미터 조정 후 성능이 **랜덤포레스트**가 더 높아 최종적 모델로 선택하였습니다.

### 6. 최종 모델(랜덤포레스트) 평가지표 해석
* 모델의 성능에 변화를 줄 수 있는 조건인 하이퍼파라미터를 변경하며 성능을 측정하고, 최적의 조건을 적용합니다.
* **특성중요도**는 1) user_id, 2) user_review, 3)rating 순으로 영향이 높았으나, **순열중요도**는 rating이 1위 입니다. 
* 위의 2항목은 개별 유저별로 표시가 되어 카디널리티가 높아 그 영향도가 높게 나왔던 것으로 보이며, 이를 제외했을때는 결국 **작품 점수**가 가장 큰 영향을 미칩니다.

<img width="800" alt="모델평가지표해석_01" src="https://user-images.githubusercontent.com/91524805/167525684-f5d03c7a-f899-4193-a4a1-74941a3e6616.png">

<img width="800" alt="모델평가지표해석_02" src="https://user-images.githubusercontent.com/91524805/167525716-c5d4b297-f78b-47ef-a276-3f8c909c6812.png">

### 7. 애니메이션 추천 시스템
* 가장 주요한 특성인 **평점**과 **유저**의 관계를 이용하여, 유사도를 판단하여 작품추천 시스템을 만듭니다.
* 특정 애니메이션을 봤을 때, 해당 작품과 유사도가 높은 다른 작품을 추천하도록 구성했습니다.

<img width="800" alt="추천시스템" src="https://user-images.githubusercontent.com/91524805/167526298-dd4c422a-1f4b-4ef9-96d4-8152918005f0.png">

### 8. 한계점 및 추후 발전방향
* 추천은 다양한 방식으로 가능하고, 절대적인 기준이 없기 때문에 개인에 맞춰 본인이 했던 평균 평점보다 새로운 작품 평점이 높으면 추천하는 모델링을 구상했습니다.
* 결과를 보면 결국 작품의 전체 평점의 영향이 가장 큽니다. 평점은 많은 정보를 함축하지만, 그저 공공의 인기를 반영하기 보다는 개인화된 추천을 위해 다른 특성들을 더 활용할 수 있는 방안에 대한 고민이 필요합니다.
* 추후에는 추천을 예측하는 모델이 **개인화**가 잘 되었는지 **더 검증**해보면 유용할 것 같습니다.  
  * 유저별 평점 분포를 살펴보고, 평균이 아니라 **상위 특정% 위에 속할 경우 추천**하는 것으로 비교 기준을 더 강화할 수 있습니다.  
  * 유저가 기존에 평가한 작품수가 많지 않을 경우, 강화된 기준을 넘어 추천하는 작품 수가 적을 수 있습니다다. 분석결과를 신뢰할 수 있는 데이터 양인지도 검증해야 합니다.  

---
### 9. 참고자료
* [캐글-클러스터링,추천시스템](https://www.kaggle.com/code/tanetboss/user-clustering-for-anime-recommendation/notebook)  
* [캐글-Cosine Similarity](https://www.kaggle.com/code/yonatanrabinovich/anime-recommendations-project/notebook)  
* [캐글-데이터 EDA](https://www.kaggle.com/code/benroshan/content-collaborative-anime-recommendation)  

